ADD_SUBDIRECTORY(fftpack)
ADD_SUBDIRECTORY(fftpack5)
ADD_SUBDIRECTORY(pppack)
ADD_SUBDIRECTORY(nufft)
ADD_SUBDIRECTORY(burkardt)

IF(BUILD_MUDPACK)
  ADD_SUBDIRECTORY(mudpack)
ENDIF(BUILD_MUDPACK)

SET(CLAPP_FRAMEWORK    OFF CACHE BOOL "Build the CLAPP framework")

IF(CLAPP_FRAMEWORK)

  INCLUDE(ExternalProject)
  EXTERNALPROJECT_ADD(
    clappio_lib
    PREFIX clapp
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/clappio.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_TESTING=OFF)
  
  EXTERNALPROJECT_ADD(
    plaf_lib
    PREFIX clapp
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/plaf.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_TESTING=OFF)

  ADD_DEPENDENCIES(plaf_lib clappio_lib)
  
  EXTERNALPROJECT_ADD(
    spl_lib
    PREFIX clapp
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/spl.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_TESTING=OFF)

  ADD_DEPENDENCIES(spl_lib plaf_lib)
  
  EXTERNALPROJECT_ADD(
    disco_lib
    PREFIX clapp
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/disco.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_TESTING=OFF)
  
  ADD_DEPENDENCIES(disco_lib spl_lib)
  
  EXTERNALPROJECT_ADD(
    glt_lib
    PREFIX clapp
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/glt.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_TESTING=OFF)

  ADD_DEPENDENCIES(glt_lib disco_lib)
  EXTERNALPROJECT_ADD(
    fema_lib
    PREFIX clapp
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/fema.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DBUILD_TESTING=OFF)

  ADD_DEPENDENCIES(fema_lib glt_lib)

  ADD_SUBDIRECTORY(clapp)

ENDIF()
