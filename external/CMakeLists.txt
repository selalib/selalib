ADD_SUBDIRECTORY(fftpack)
ADD_SUBDIRECTORY(fftpack5)
ADD_SUBDIRECTORY(pppack)
ADD_SUBDIRECTORY(nufft)
ADD_SUBDIRECTORY(burkardt)

IF(BUILD_MUDPACK)
  ADD_SUBDIRECTORY(mudpack)
ENDIF(BUILD_MUDPACK)

SET(BUILD_SPIGA    OFF CACHE BOOL "SPIGA Structure Preserving IsoGeometric Analysis")

IF(BUILD_SPIGA)

  INCLUDE(ExternalProject)
  EXTERNALPROJECT_ADD(
    clappio_lib
    PREFIX clappio
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/clappio.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE})
  
  EXTERNALPROJECT_ADD(
    plaf_lib
    PREFIX plaf
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/plaf.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE})

  ADD_DEPENDENCIES(plaf_lib clappio_lib)
  
  EXTERNALPROJECT_ADD(
    spl_lib
    PREFIX spl
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/spl.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE})

  ADD_DEPENDENCIES(spl_lib plaf_lib)
  
  EXTERNALPROJECT_ADD(
    disco_lib
    PREFIX disco
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/disco.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE})
  
  ADD_DEPENDENCIES(disco_lib spl_lib)
  
  EXTERNALPROJECT_ADD(
    glt_lib
    PREFIX fema
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/glt.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_EXAMPLES=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DPLAF_DIR=${CMAKE_BINARY_DIR})

  ADD_DEPENDENCIES(glt_lib disco_lib)
  EXTERNALPROJECT_ADD(
    fema_lib
    PREFIX fema
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/fema.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_EXAMPLES=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DPLAF_DIR=${CMAKE_BINARY_DIR})

  ADD_DEPENDENCIES(fema_lib glt_lib)
  EXTERNALPROJECT_ADD(
    spiga_lib
    PREFIX spiga
    GIT_TAG devel
    GIT_REPOSITORY git@gitlab.mpcdf.mpg.de:clapp/spiga.git
    CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR} -DBUILD_EXAMPLES=OFF -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} -DPLAF_DIR=${CMAKE_BINARY_DIR})

   ADD_DEPENDENCIES(spiga_lib fema_lib)
   ADD_SUBDIRECTORY(spiga)

ENDIF()
