#******************************************
# job parameters
#******************************************
TIME         = 01:00:00
JOBNAME      = DK4D

#*******************************************
#  Variables for parallelization
#*******************************************
MPIPROCS = 16
NNODES   = 1
NTHREAD  = 1

#*******************************************
# DK4D input datas
#*******************************************
&mesh
  num_cells_x1 = 32 !128
  num_cells_x2 = 32 !128
  num_cells_x3 = 32 !32
  num_cells_x4 = 64
  r_min        = 0.1
  r_max        = 14.5
  eta3_min     = 0.
  !--> Lphi = Lz = 2*pi*R0 where R0 = minor_radius*aspect_ratio
  !-->  ex: Lphi = 1503.2521 with minor_radius = 14.5 and aspect_ratio = 16.5
  eta3_max     = 1506.759067
  vpar_min     = -7.32
  vpar_max     = 7.32
/

&equilibrium
  tau0     = 1.
  rho_peak = 0.5
  kappan   = 13.2   !-> inv_Ln = kappan/R0
  deltarn  = 0.2
  kappaTi  = 66.    !-> inv_LTi = kappaTi/R0
  deltarTi = 0.1
  kappaTe  = 66.    !-> inv_LTe = kappaTe/R0
  deltarTe = 0.1
/

&perturbation
  perturb_choice = 1
  mmode          = 5
  nmode          = 1
  eps_perturb    = 1.0e-6
/

&sim_params
  scheme_type        = "BSL_HYBRID"
  time_loop_type     = "TIME_LOOP_EULER"
!  time_loop_type     = "TIME_LOOP_PREDICTOR_CORRECTOR"
  dt                 = 2.
  number_iterations  = 10
  spline_degree_eta1 = 3
  spline_degree_eta2 = 3
  spline_degree_eta3 = 3
  spline_degree_vpar = 3
/

&diagnostics
   diag2D_step = 2. !32.0 
/

&tests
   advec_in_eta1eta2 = .true.
   advec_in_eta3     = .true.
   advec_in_vpar     = .true.
/
