<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>Semi-Lagrangian Library: sll_m_particle_group_2d2v_lbf Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div align=right><a href="https://github.com/selalib/selalib/issues/new"><small>Report Typos and Errors &nbsp; &nbsp;</small></a></div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="selalib.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Semi-Lagrangian Library
   </div>
   <div id="projectbrief">Modular library for kinetic and gyrokinetic simulations of plasmas in fusion energy devices.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Derived types and interfaces</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sll_m_particle_group_2d2v_lbf Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>Module for a particle group with linearized-backward-flow (lbf) resamplings. </p>
<dl class="section author"><dt>Author</dt><dd>MCP </dd></dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Derived types and interfaces</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element.html">sll_t_int_list_element</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">linked lists of integers, used in some of the module routines  <a href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element__ptr.html">sll_t_int_list_element_ptr</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">a pointer type is needed for arrays of lists  <a href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element__ptr.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Group of <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>.  <a href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4f879ea53f9ad4f834c4459373c68ea8"><td class="memItemLeft" align="right" valign="top">pure real(kind=f64) function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a4f879ea53f9ad4f834c4459373c68ea8">get_x_2d2v_lbf</a> (self, i)</td></tr>
<tr class="memdesc:a4f879ea53f9ad4f834c4459373c68ea8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getters ----------------------------------------------------------------------------------------------------------------&mdash;.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a4f879ea53f9ad4f834c4459373c68ea8">More...</a><br /></td></tr>
<tr class="separator:a4f879ea53f9ad4f834c4459373c68ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09b99c776bac47b3fef6d32c4c2248f"><td class="memItemLeft" align="right" valign="top">pure real(kind=f64) function, dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ae09b99c776bac47b3fef6d32c4c2248f">get_v_2d2v_lbf</a> (self, i)</td></tr>
<tr class="memdesc:ae09b99c776bac47b3fef6d32c4c2248f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the velocity of a particle.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ae09b99c776bac47b3fef6d32c4c2248f">More...</a><br /></td></tr>
<tr class="separator:ae09b99c776bac47b3fef6d32c4c2248f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e6fee71da9516e40f0ba3fb248e8d7"><td class="memItemLeft" align="right" valign="top">pure real(kind=f64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ad6e6fee71da9516e40f0ba3fb248e8d7">get_charge_2d2v_lbf</a> (self, i, i_weight)</td></tr>
<tr class="memdesc:ad6e6fee71da9516e40f0ba3fb248e8d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get charge of a particle (q * particle_weight)  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ad6e6fee71da9516e40f0ba3fb248e8d7">More...</a><br /></td></tr>
<tr class="separator:ad6e6fee71da9516e40f0ba3fb248e8d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20fbafd52182cc2d68689b839b26a5a"><td class="memItemLeft" align="right" valign="top">pure real(kind=f64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ad20fbafd52182cc2d68689b839b26a5a">get_mass_2d2v_lbf</a> (self, i, i_weight)</td></tr>
<tr class="memdesc:ad20fbafd52182cc2d68689b839b26a5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get mass of a particle ( m * particle_weight)  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ad20fbafd52182cc2d68689b839b26a5a">More...</a><br /></td></tr>
<tr class="separator:ad20fbafd52182cc2d68689b839b26a5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9888ed0ea6fcd0632e716809f712c76a"><td class="memItemLeft" align="right" valign="top">pure real(kind=f64) function, dimension(self%n_weights)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a9888ed0ea6fcd0632e716809f712c76a">get_weights_2d2v_lbf</a> (self, i)</td></tr>
<tr class="memdesc:a9888ed0ea6fcd0632e716809f712c76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get weights of a particle.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a9888ed0ea6fcd0632e716809f712c76a">More...</a><br /></td></tr>
<tr class="separator:a9888ed0ea6fcd0632e716809f712c76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9710bdf0a4e7424071edaf9a1cb26f4a"><td class="memItemLeft" align="right" valign="top">pure real(kind=f64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a9710bdf0a4e7424071edaf9a1cb26f4a">get_common_weight_2d2v_lbf</a> (self)</td></tr>
<tr class="memdesc:a9710bdf0a4e7424071edaf9a1cb26f4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the common weight.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a9710bdf0a4e7424071edaf9a1cb26f4a">More...</a><br /></td></tr>
<tr class="separator:a9710bdf0a4e7424071edaf9a1cb26f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d4fd31294cc5ab020aceee2ff95049"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a57d4fd31294cc5ab020aceee2ff95049">set_x_2d2v_lbf</a> (self, i, x)</td></tr>
<tr class="memdesc:a57d4fd31294cc5ab020aceee2ff95049"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setters ----------------------------------------------------------------------------------------------------------------&mdash;.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a57d4fd31294cc5ab020aceee2ff95049">More...</a><br /></td></tr>
<tr class="separator:a57d4fd31294cc5ab020aceee2ff95049"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22c383557ce166737f07d02d7ed406e5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a22c383557ce166737f07d02d7ed406e5">set_v_2d2v_lbf</a> (self, i, x)</td></tr>
<tr class="memdesc:a22c383557ce166737f07d02d7ed406e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the velocity of a particle.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a22c383557ce166737f07d02d7ed406e5">More...</a><br /></td></tr>
<tr class="separator:a22c383557ce166737f07d02d7ed406e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac604cda68a7d4ca9153c82a11dcde28f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ac604cda68a7d4ca9153c82a11dcde28f">set_weights_2d2v_lbf</a> (self, i, x)</td></tr>
<tr class="memdesc:ac604cda68a7d4ca9153c82a11dcde28f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the weights of a particle.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ac604cda68a7d4ca9153c82a11dcde28f">More...</a><br /></td></tr>
<tr class="separator:ac604cda68a7d4ca9153c82a11dcde28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07829ac7f014e188bee3876add24357"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#af07829ac7f014e188bee3876add24357">set_common_weight_2d2v_lbf</a> (self, x)</td></tr>
<tr class="memdesc:af07829ac7f014e188bee3876add24357"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the common weight.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#af07829ac7f014e188bee3876add24357">More...</a><br /></td></tr>
<tr class="separator:af07829ac7f014e188bee3876add24357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98a7e81c8f6e1fa80a8984becf01a416"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a98a7e81c8f6e1fa80a8984becf01a416">initialize_particle_group_2d2v_lbf</a> (self, species_charge, species_mass, domain_is_x_periodic, domain_is_y_periodic, remap_degree, remapping_grid_eta_min, remapping_grid_eta_max, remapping_sparse_grid_max_levels, n_particles_x, n_particles_y, n_particles_vx, n_particles_vy, n_weights)</td></tr>
<tr class="memdesc:a98a7e81c8f6e1fa80a8984becf01a416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializer ------------------------------------------------------------------------------------------------------------&mdash; Initialize particle group.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a98a7e81c8f6e1fa80a8984becf01a416">More...</a><br /></td></tr>
<tr class="separator:a98a7e81c8f6e1fa80a8984becf01a416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93c60aa5f0430a547ce02f5768b505c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#aa93c60aa5f0430a547ce02f5768b505c">sll_s_new_particle_group_2d2v_lbf_ptr</a> (particle_group, species_charge, species_mass, domain_is_x_periodic, domain_is_y_periodic, remap_degree, remapping_grid_eta_min, remapping_grid_eta_max, remapping_sparse_grid_max_levels, n_particles_x, n_particles_y, n_particles_vx, n_particles_vy)</td></tr>
<tr class="memdesc:aa93c60aa5f0430a547ce02f5768b505c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for abstract type.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#aa93c60aa5f0430a547ce02f5768b505c">More...</a><br /></td></tr>
<tr class="separator:aa93c60aa5f0430a547ce02f5768b505c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a524d0e714ae678c97e369c6af21de07f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a524d0e714ae678c97e369c6af21de07f">delete_particle_group_2d2v_lbf</a> (self)</td></tr>
<tr class="memdesc:a524d0e714ae678c97e369c6af21de07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor -------------------------------------------------------------------------------------------------------------&mdash;.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a524d0e714ae678c97e369c6af21de07f">More...</a><br /></td></tr>
<tr class="separator:a524d0e714ae678c97e369c6af21de07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a494e65998fd6a757facd995773e3f976"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a494e65998fd6a757facd995773e3f976">sample</a> (self, target_total_charge, enforce_total_charge, init_f_params, rand_seed, rank, world_size)</td></tr>
<tr class="memdesc:a494e65998fd6a757facd995773e3f976"><td class="mdescLeft">&#160;</td><td class="mdescRight">sample (layer for resample procedure) ----------------------------------------------------------------------------------&mdash; this routine essentially does 2 things:  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a494e65998fd6a757facd995773e3f976">More...</a><br /></td></tr>
<tr class="separator:a494e65998fd6a757facd995773e3f976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1e3ded1bdad15c03d4cf145ebe4f4ac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ac1e3ded1bdad15c03d4cf145ebe4f4ac">resample</a> (self, target_total_charge, enforce_total_charge, init_f_params, rand_seed, rank, world_size)</td></tr>
<tr class="memdesc:ac1e3ded1bdad15c03d4cf145ebe4f4ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">resample (and sample) --------------------------------------------------------------------------------------------------&mdash; this routine essentially does 2 things:  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ac1e3ded1bdad15c03d4cf145ebe4f4ac">More...</a><br /></td></tr>
<tr class="separator:ac1e3ded1bdad15c03d4cf145ebe4f4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56539bc9169e9fdcebd3faa64eae7957"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a56539bc9169e9fdcebd3faa64eae7957">write_known_density_on_remapping_grid</a> (self, distribution_params)</td></tr>
<tr class="memdesc:a56539bc9169e9fdcebd3faa64eae7957"><td class="mdescLeft">&#160;</td><td class="mdescRight">write_known_density_on_remapping_grid ----------------------------------------------------------------------------------&mdash; this routine writes a given distribution on the interpolation (sparse grid) nodes to further approximate it  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a56539bc9169e9fdcebd3faa64eae7957">More...</a><br /></td></tr>
<tr class="separator:a56539bc9169e9fdcebd3faa64eae7957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51a50ee826089e37eaa91d719d398753"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a51a50ee826089e37eaa91d719d398753">reset_particles_positions</a> (self)</td></tr>
<tr class="memdesc:a51a50ee826089e37eaa91d719d398753"><td class="mdescLeft">&#160;</td><td class="mdescRight">reset_particles_positions ----------------------------------------------------------------------------------------------&mdash; reset the particles on the initial (cartesian) grid &ndash; we use the (multi-purpose) lbf grid &ndash; NOTE: particles will be located at the center of each cell (to avoid a particular treatment of periodic domains)  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a51a50ee826089e37eaa91d719d398753">More...</a><br /></td></tr>
<tr class="separator:a51a50ee826089e37eaa91d719d398753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a522dd13e569503cf5d605042472910ba"><td class="memItemLeft" align="right" valign="top">integer(kind=i32) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a522dd13e569503cf5d605042472910ba">get_neighbor_index</a> (self, k, dim, dir)</td></tr>
<tr class="memdesc:a522dd13e569503cf5d605042472910ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_neighbor_index -----------------------------------------------------------------------------------------------------&mdash; returns the index of the specified particle neighbor (defines the particle connectivity)  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a522dd13e569503cf5d605042472910ba">More...</a><br /></td></tr>
<tr class="separator:a522dd13e569503cf5d605042472910ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450be1dcd1264dea91377d49951443cb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a450be1dcd1264dea91377d49951443cb">reset_particles_weights_with_direct_interpolation</a> (self, target_total_charge, enforce_total_charge)</td></tr>
<tr class="memdesc:a450be1dcd1264dea91377d49951443cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">reset_particles_weights_with_direct_interpolation ----------------------------------------------------------------------&mdash; compute (and set) the particle weights using a direct interpolation (here, sparse grid) &ndash; does not change the position of the deposition particles  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a450be1dcd1264dea91377d49951443cb">More...</a><br /></td></tr>
<tr class="separator:a450be1dcd1264dea91377d49951443cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36e733b4d5d5e71ceed9608e9ca3525"><td class="memItemLeft" align="right" valign="top">real(kind=f64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ae36e733b4d5d5e71ceed9608e9ca3525">interpolate_value_of_remapped_f</a> (self, eta)</td></tr>
<tr class="memdesc:ae36e733b4d5d5e71ceed9608e9ca3525"><td class="mdescLeft">&#160;</td><td class="mdescRight">interpolate_value_of_remapped_f ----------------------------------------------------------------------------------------&mdash; computes the value of the (last) remapped density f using the interpolation tool &ndash; for now, assuming only sparse grid interpolation  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ae36e733b4d5d5e71ceed9608e9ca3525">More...</a><br /></td></tr>
<tr class="separator:ae36e733b4d5d5e71ceed9608e9ca3525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0fbfbcefa33b4905389cc58fbeda05"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a8d0fbfbcefa33b4905389cc58fbeda05">reconstruct_f_lbf</a> (self, reconstruction_set_type, given_grid_4d, given_array_4d, reconstruct_f_on_last_node, target_total_charge, enforce_total_charge)</td></tr>
<tr class="memdesc:a8d0fbfbcefa33b4905389cc58fbeda05"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro for the lbf approximation of a transported density (reconstruct_f_lbf) below -------------------------------------&mdash;  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a8d0fbfbcefa33b4905389cc58fbeda05">More...</a><br /></td></tr>
<tr class="separator:a8d0fbfbcefa33b4905389cc58fbeda05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb8d3258ffcc102190fcd9f887389f4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#adbb8d3258ffcc102190fcd9f887389f4">reconstruct_f_lbf_on_remapping_grid</a> (self)</td></tr>
<tr class="memdesc:adbb8d3258ffcc102190fcd9f887389f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">reconstruct_f_lbf_on_remapping_grid ------------------------------------------------------------------------------------&mdash; layer for reconstruct_f_lbf, when reconstructing f on the remapping grid  <a href="namespacesll__m__particle__group__2d2v__lbf.html#adbb8d3258ffcc102190fcd9f887389f4">More...</a><br /></td></tr>
<tr class="separator:adbb8d3258ffcc102190fcd9f887389f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e13e2a9873ee5ec306356da83eda6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ad5e13e2a9873ee5ec306356da83eda6e">reconstruct_f_lbf_on_given_grid</a> (self, given_grid_4d, given_array_4d, reconstruct_f_on_last_node, target_total_charge, enforce_total_charge)</td></tr>
<tr class="memdesc:ad5e13e2a9873ee5ec306356da83eda6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">reconstruct_f_lbf_on_remapping_grid ------------------------------------------------------------------------------------&mdash; layer for reconstruct_f_lbf, when reconstructing f on a given grid  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ad5e13e2a9873ee5ec306356da83eda6e">More...</a><br /></td></tr>
<tr class="separator:ad5e13e2a9873ee5ec306356da83eda6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75109c7df7d931d2e068fb493f6394bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a75109c7df7d931d2e068fb493f6394bd">get_ltp_deformation_matrix</a> (self, k, mesh_period_x, mesh_period_y, h_particles_x, h_particles_y, h_particles_vx, h_particles_vy, x_k, y_k, vx_k, vy_k, d11, d12, d13, d14, d21, d22, d23, d24, d31, d32, d33, d34, d41, d42, d43, d44)</td></tr>
<tr class="memdesc:a75109c7df7d931d2e068fb493f6394bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_ltp_deformation_matrix ---------------------------------------------------------------------------------------------&mdash; Compute the coefficients of the particle 'deformation' matrix which actually approximates the Jacobian matrix of the exact backward flow (defined between the current time and that of the particle initialization &ndash; or the last particle remapping) at the current particle position.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a75109c7df7d931d2e068fb493f6394bd">More...</a><br /></td></tr>
<tr class="separator:a75109c7df7d931d2e068fb493f6394bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c7023c3346377d9d627beef7d4be09"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#af4c7023c3346377d9d627beef7d4be09">periodic_correction</a> (p_group, x, y)</td></tr>
<tr class="memdesc:af4c7023c3346377d9d627beef7d4be09"><td class="mdescLeft">&#160;</td><td class="mdescRight">periodic_correction ----------------------------------------------------------------------------------------------------&mdash; puts the point (x,y) back into the computational domain if periodic in x or y (or both) otherwise, does nothing  <a href="namespacesll__m__particle__group__2d2v__lbf.html#af4c7023c3346377d9d627beef7d4be09">More...</a><br /></td></tr>
<tr class="separator:af4c7023c3346377d9d627beef7d4be09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd7436d27d911764b09845a4755911bb"><td class="memItemLeft" align="right" valign="top">type(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element.html">sll_t_int_list_element</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#afd7436d27d911764b09845a4755911bb">sll_f_add_element_in_int_list</a> (head, new_element)</td></tr>
<tr class="memdesc:afd7436d27d911764b09845a4755911bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">sll_f_add_element_in_int_list ------------------------------------------------------------------------------------------&mdash; list management  <a href="namespacesll__m__particle__group__2d2v__lbf.html#afd7436d27d911764b09845a4755911bb">More...</a><br /></td></tr>
<tr class="separator:afd7436d27d911764b09845a4755911bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c81cd38ca6e0bb185a2020db2114194"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a7c81cd38ca6e0bb185a2020db2114194">convert_4d_index_to_1d</a> (k, j_x, j_y, j_vx, j_vy, n_parts_x, n_parts_y, n_parts_vx, n_parts_vy)</td></tr>
<tr class="memdesc:a7c81cd38ca6e0bb185a2020db2114194"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert_4d_index_to_1d -------------------------------------------------------------------------------------------------&mdash; given the 4d index of a node on a cartesian grid, returns its 1d index in some assumed order see inverse function convert_1d_index_to_4d  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a7c81cd38ca6e0bb185a2020db2114194">More...</a><br /></td></tr>
<tr class="separator:a7c81cd38ca6e0bb185a2020db2114194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b68d806fa4ea6623a7aad38a915919"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#ab5b68d806fa4ea6623a7aad38a915919">convert_1d_index_to_4d</a> (j_x, j_y, j_vx, j_vy, k, n_parts_x, n_parts_y, n_parts_vx, n_parts_vy)</td></tr>
<tr class="memdesc:ab5b68d806fa4ea6623a7aad38a915919"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert_1d_index_to_4d -------------------------------------------------------------------------------------------------&mdash; given the 1d index of a node on a cartesian grid (with some assumed order), returns its 4d index see inverse function convert_4d_index_to_1d  <a href="namespacesll__m__particle__group__2d2v__lbf.html#ab5b68d806fa4ea6623a7aad38a915919">More...</a><br /></td></tr>
<tr class="separator:ab5b68d806fa4ea6623a7aad38a915919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d0afa9ddf3075811d66678300163b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a72d0afa9ddf3075811d66678300163b7">get_1d_cell_containing_point</a> (j, x, x_min, h)</td></tr>
<tr class="memdesc:a72d0afa9ddf3075811d66678300163b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">get_1d_cell_containing_point -------------------------------------------------------------------------------------------&mdash; elementary function to compute the index j of the 1d cell containing a point x, ie x_min + (j-1)*h &lt;= x &lt; x_min + j*h bounds check should be performed outside this routine  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a72d0afa9ddf3075811d66678300163b7">More...</a><br /></td></tr>
<tr class="separator:a72d0afa9ddf3075811d66678300163b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853fc5fca7bb0ba78fbc632c0ae8f5c3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a853fc5fca7bb0ba78fbc632c0ae8f5c3">update_closest_particle_arrays</a> (k_part, x_aux, y_aux, vx_aux, vy_aux, i, j, l, m, h_cell_x, h_cell_y, h_cell_vx, h_cell_vy, closest_particle, closest_particle_distance)</td></tr>
<tr class="memdesc:a853fc5fca7bb0ba78fbc632c0ae8f5c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">update_closest_particle_arrays -----------------------------------------------------------------------------------------&mdash; update the arrays closest_particle and closest_particle_distance with the index of the given particle if closer to what had been stored up to now.  <a href="namespacesll__m__particle__group__2d2v__lbf.html#a853fc5fca7bb0ba78fbc632c0ae8f5c3">More...</a><br /></td></tr>
<tr class="separator:a853fc5fca7bb0ba78fbc632c0ae8f5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa99d08545655ad53138b0dcef8ad4fee"><td class="memItemLeft" align="right" valign="top">integer(kind=i32), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#aa99d08545655ad53138b0dcef8ad4fee">sll_p_lbf_remapping_grid</a> = 1</td></tr>
<tr class="memdesc:aa99d08545655ad53138b0dcef8ad4fee"><td class="mdescLeft">&#160;</td><td class="mdescRight">possible values for the parameter reconstruction_set_type in the reconstruction routine  <a href="namespacesll__m__particle__group__2d2v__lbf.html#aa99d08545655ad53138b0dcef8ad4fee">More...</a><br /></td></tr>
<tr class="separator:aa99d08545655ad53138b0dcef8ad4fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7618e792c8fc501390695c1027bc0d03"><td class="memItemLeft" align="right" valign="top">integer(kind=i32), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesll__m__particle__group__2d2v__lbf.html#a7618e792c8fc501390695c1027bc0d03">sll_p_lbf_given_grid</a> = 2</td></tr>
<tr class="separator:a7618e792c8fc501390695c1027bc0d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ab5b68d806fa4ea6623a7aad38a915919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b68d806fa4ea6623a7aad38a915919">&#9670;&nbsp;</a></span>convert_1d_index_to_4d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::convert_1d_index_to_4d </td>
          <td>(</td>
          <td class="paramtype">integer(kind=i32), intent(out)&#160;</td>
          <td class="paramname"><em>j_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(out)&#160;</td>
          <td class="paramname"><em>j_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(out)&#160;</td>
          <td class="paramname"><em>j_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(out)&#160;</td>
          <td class="paramname"><em>j_vy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_vy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>convert_1d_index_to_4d -------------------------------------------------------------------------------------------------&mdash; given the 1d index of a node on a cartesian grid (with some assumed order), returns its 4d index see inverse function convert_4d_index_to_1d </p>
<p>here, k_aux = (j_vy-1) + (j_vx-1) * n_parts_vy + (j_y-1) * n_parts_vy * n_parts_vx + (j_x-1) * n_parts_vy * n_parts_vx * n_parts_y</p>
<p>here, k_aux = (j_vx-1) + (j_y-1) * n_parts_vx + (j_x-1) * n_parts_vx * n_parts_y</p>
<p>here, k_aux = (j_y-1) + (j_x-1) * n_parts_y</p>
<p>here, k_aux = (j_x-1)</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l02094">2094</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_ab5b68d806fa4ea6623a7aad38a915919_icgraph.svg" width="390" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7c81cd38ca6e0bb185a2020db2114194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c81cd38ca6e0bb185a2020db2114194">&#9670;&nbsp;</a></span>convert_4d_index_to_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::convert_4d_index_to_1d </td>
          <td>(</td>
          <td class="paramtype">integer(kind=i32), intent(out)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>j_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>j_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>j_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>j_vy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_parts_vy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>convert_4d_index_to_1d -------------------------------------------------------------------------------------------------&mdash; given the 4d index of a node on a cartesian grid, returns its 1d index in some assumed order see inverse function convert_1d_index_to_4d </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l02064">2064</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a7c81cd38ca6e0bb185a2020db2114194_icgraph.svg" width="423" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a524d0e714ae678c97e369c6af21de07f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a524d0e714ae678c97e369c6af21de07f">&#9670;&nbsp;</a></span>delete_particle_group_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::delete_particle_group_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor -------------------------------------------------------------------------------------------------------------&mdash;. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>particle group </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00443">443</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a72d0afa9ddf3075811d66678300163b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d0afa9ddf3075811d66678300163b7">&#9670;&nbsp;</a></span>get_1d_cell_containing_point()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::get_1d_cell_containing_point </td>
          <td>(</td>
          <td class="paramtype">integer(kind=i32), intent(out)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>x_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get_1d_cell_containing_point -------------------------------------------------------------------------------------------&mdash; elementary function to compute the index j of the 1d cell containing a point x, ie x_min + (j-1)*h &lt;= x &lt; x_min + j*h bounds check should be performed outside this routine </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l02133">2133</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a72d0afa9ddf3075811d66678300163b7_icgraph.svg" width="360" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad6e6fee71da9516e40f0ba3fb248e8d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e6fee71da9516e40f0ba3fb248e8d7">&#9670;&nbsp;</a></span>get_charge_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=f64) function sll_m_particle_group_2d2v_lbf::get_charge_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in), optional&#160;</td>
          <td class="paramname"><em>i_weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get charge of a particle (q * particle_weight) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_weight</td><td>weight index to be used (default: 1) - not needed now </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>charge of particle i </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00186">186</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a9710bdf0a4e7424071edaf9a1cb26f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9710bdf0a4e7424071edaf9a1cb26f4a">&#9670;&nbsp;</a></span>get_common_weight_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=f64) function sll_m_particle_group_2d2v_lbf::get_common_weight_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the common weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>particle group </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>common weight </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00231">231</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a75109c7df7d931d2e068fb493f6394bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75109c7df7d931d2e068fb493f6394bd">&#9670;&nbsp;</a></span>get_ltp_deformation_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::get_ltp_deformation_matrix </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>mesh_period_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>mesh_period_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_particles_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_particles_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_particles_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_particles_vy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>x_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>y_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>vx_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>vy_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d13</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d14</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d21</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d22</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d23</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d24</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d31</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d33</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d34</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d41</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d42</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d43</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(out)&#160;</td>
          <td class="paramname"><em>d44</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get_ltp_deformation_matrix ---------------------------------------------------------------------------------------------&mdash; Compute the coefficients of the particle 'deformation' matrix which actually approximates the Jacobian matrix of the exact backward flow (defined between the current time and that of the particle initialization &ndash; or the last particle remapping) at the current particle position. </p>
<p>Note: the 'deformation matrix' terminology comes from the LTP method, but with the lbf reconstruction method we are not deforming particles anymore. This matrix is just used as the approximate backward Jacobian matrix</p>
<p>It is computed in two steps:</p><ul>
<li>first we compute a finite-difference approximation of the forward Jacobian matrix by using the fact that the initial (or remapped) particles were located on a cartesian grid in phase space. Specifically, the entries of the forward Jacobian matrix (say, (J^n_k)_xy = d(F^n_x)/dy (z^0_k) &ndash; with z is the phase space coordinate) are approximated by finite differences: here, by DF / 2*h_y with DF = F^n_x(z^0_k + (0,h_y,0,0)) - F^n_x(z^0_k - (0,h_y,0,0))</li>
<li>then we invert that approximated forward Jacobian matrix</li>
</ul>
<p>Note: when computing finite differences in a periodic dimension (say x), one must be careful since two values of F_x can be close in the periodic interval but distant by almost L_x in the (stored) [0,L_x[ representation. To account for this (frequent) phenomenon we do the following: when the difference DF (see example above) is larger than L_x/2, we make it smaller by adding +/- L_x to it. Note that here we could very well be making the slope smaller than what it should actually be: indeed if the function F^n_x is having a steep slope at z^0_k which adds one (or several) periods L_x to DF then our modification will artificially lower the slope. But this is impossible to prevent in full generality (indeed: a steep slope crossing the 0 or L_x value will be lowered anyway in the [0,L_x[ representation) and should not be frequent (indeed it only happens when F^n_x has high derivatives and the particle grid is coarse, which will lead to bad approximations anyhow). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">y_k</td><td>particle center in physical space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vy_k</td><td>particle center in velocity space </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d14</td><td>coefs of matrix D (backward Jacobian) </td></tr>
  </table>
  </dd>
</dl>
<p>Compute the forward Jacobian matrix J_k</p>
<p>---&mdash; d/d_x terms</p>
<p>no right neighbor is available, use a non-centered finite difference</p>
<p>no left neighbor is available, use a non-centered finite difference</p>
<p>---&mdash; d/d_y terms</p>
<p>no right neighbor is available, use a non-centered finite difference</p>
<p>no left neighbor is available, use a non-centered finite difference</p>
<p>---&mdash; d/d_vx terms</p>
<p>no right neighbor is available, use a non-centered finite difference</p>
<p>no left neighbor is available, use a non-centered finite difference</p>
<p>---&mdash; d/d_vy terms</p>
<p>no right neighbor is available, use a non-centered finite difference</p>
<p>no left neighbor is available, use a non-centered finite difference</p>
<p>Compute D_k the inverse of J_k</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l01586">1586</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="ad20fbafd52182cc2d68689b839b26a5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20fbafd52182cc2d68689b839b26a5a">&#9670;&nbsp;</a></span>get_mass_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=f64) function sll_m_particle_group_2d2v_lbf::get_mass_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in), optional&#160;</td>
          <td class="paramname"><em>i_weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get mass of a particle ( m * particle_weight) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_weight</td><td>weight index to be used (default: 1) - not needed now </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mass of particle i </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00203">203</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a522dd13e569503cf5d605042472910ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a522dd13e569503cf5d605042472910ba">&#9670;&nbsp;</a></span>get_neighbor_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(kind=i32) function sll_m_particle_group_2d2v_lbf::get_neighbor_index </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get_neighbor_index -----------------------------------------------------------------------------------------------------&mdash; returns the index of the specified particle neighbor (defines the particle connectivity) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>particle index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim</td><td>neighbor dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dir</td><td>neighbor direction (-1: left, 1:right) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>neighbor particle index </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00633">633</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a522dd13e569503cf5d605042472910ba_cgraph.svg" width="390" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae09b99c776bac47b3fef6d32c4c2248f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae09b99c776bac47b3fef6d32c4c2248f">&#9670;&nbsp;</a></span>get_v_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=f64) function, dimension(3) sll_m_particle_group_2d2v_lbf::get_v_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the velocity of a particle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>first two components hold the value of the particle velocity </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00172">172</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a9888ed0ea6fcd0632e716809f712c76a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9888ed0ea6fcd0632e716809f712c76a">&#9670;&nbsp;</a></span>get_weights_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=f64) function, dimension(self%n_weights) sll_m_particle_group_2d2v_lbf::get_weights_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get weights of a particle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>no. of the particle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>particle weight(s) </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00220">220</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a4f879ea53f9ad4f834c4459373c68ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f879ea53f9ad4f834c4459373c68ea8">&#9670;&nbsp;</a></span>get_x_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(kind=f64) function, dimension(3) sll_m_particle_group_2d2v_lbf::get_x_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getters ----------------------------------------------------------------------------------------------------------------&mdash;. </p>
<p>Get the physical coordinates of a particle </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>first two components hold the value of the particle position </dd></dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00160">160</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a98a7e81c8f6e1fa80a8984becf01a416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98a7e81c8f6e1fa80a8984becf01a416">&#9670;&nbsp;</a></span>initialize_particle_group_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::initialize_particle_group_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>species_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>species_mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>domain_is_x_periodic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>domain_is_y_periodic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>remap_degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>remapping_grid_eta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>remapping_grid_eta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>remapping_sparse_grid_max_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_vy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializer ------------------------------------------------------------------------------------------------------------&mdash; Initialize particle group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_weights</td><td>number of weights per particle (only 1 for now) </td></tr>
  </table>
  </dd>
</dl>
<p>create the species object for this particle group</p>
<p>A. discretization of the flow: the flow grid is the 4d cartesian grid where the backward flow is linearized in this deterministic case, the particles are initially located at the center of each flow cell</p>
<p>B. discretization of the remapped f, with sparse grids</p>
<p>C. array of sparse grid coefficients for remapped_f</p>
<p>this array is to store temporary values of remapped f, while those of previously remapped f still needed</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00287">287</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a98a7e81c8f6e1fa80a8984becf01a416_cgraph.svg" width="376" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae36e733b4d5d5e71ceed9608e9ca3525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36e733b4d5d5e71ceed9608e9ca3525">&#9670;&nbsp;</a></span>interpolate_value_of_remapped_f()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=f64) function sll_m_particle_group_2d2v_lbf::interpolate_value_of_remapped_f </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>eta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>interpolate_value_of_remapped_f ----------------------------------------------------------------------------------------&mdash; computes the value of the (last) remapped density f using the interpolation tool &ndash; for now, assuming only sparse grid interpolation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>Position where to interpolate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00798">798</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_ae36e733b4d5d5e71ceed9608e9ca3525_cgraph.svg" width="391" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af4c7023c3346377d9d627beef7d4be09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c7023c3346377d9d627beef7d4be09">&#9670;&nbsp;</a></span>periodic_correction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::periodic_correction </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(in)&#160;</td>
          <td class="paramname"><em>p_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(inout)&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>periodic_correction ----------------------------------------------------------------------------------------------------&mdash; puts the point (x,y) back into the computational domain if periodic in x or y (or both) otherwise, does nothing </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l02033">2033</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_af4c7023c3346377d9d627beef7d4be09_icgraph.svg" width="362" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8d0fbfbcefa33b4905389cc58fbeda05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0fbfbcefa33b4905389cc58fbeda05">&#9670;&nbsp;</a></span>reconstruct_f_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::reconstruct_f_lbf </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>reconstruction_set_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsll__m__cartesian__meshes_1_1sll__t__cartesian__mesh__4d.html">sll_t_cartesian_mesh_4d</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>given_grid_4d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(:,:,:,:), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>given_array_4d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>reconstruct_f_on_last_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>target_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>enforce_total_charge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>macro for the lbf approximation of a transported density (reconstruct_f_lbf) below -------------------------------------&mdash; </p>
<p>reconstruct_f_lbf -------------------------------------------------------------------------------------------------------&mdash; reconstruct point values of the transported f using a bsl approximation based on linearized backward flows (lbf) values are reconstructed on different grids, depending on reconstruction_set_type:</p><ul>
<li>sll_p_lbf_remapping_grid: the remapping grid (for now, a sparse grid)</li>
<li>sll_p_lbf_given_grid: a 4d cartesian grid </li>
</ul>
<p>index of particle closest to the center of each flow cell</p>
<p>array of integer linked lists (declared below) useful when remapping on sparse grids (can also simplify the code when remapping on cartesian grids which do not match with the flow cells? but maybe too costly)</p>
<p>&lt;&lt;g&gt;&gt; cartesian grid pointer to the remapping grid</p>
<p>the flow cells are the cells where the flow will be linearized</p>
<p>results from [[get_ltp_deformation_matrix]]</p>
<p>coordinates of particle k at time n and time 0</p>
<p>coordinates of a reconstruction point at time 0, absolute</p>
<p>coordinates of a reconstruction point at time 0, relative to the nearby reference particle (= closest to cell center)</p>
<p>getting the parameters of the flow grid (where the bwd flow is linearized)</p>
<p>reconstruction will be done through local linearization of the bwd flow in flow cells. these flow cells are defined by the lbf_grid but we may not need all of them (if reconstructing f on a given grid, see below)</p>
<p>A. preparation of the point sets where f will be reconstructed, depending on the cases</p>
<p>=&gt; prepare the array of linked lists that will store the node indices contained in the flow cells (one list per cell)</p>
<p>then loop to store the sparse grid node indices in linked lists corresponding to the flow cells that contain them</p>
<p>get node coordinates:</p>
<p>find the index (j_x,j_y,j_vx,j_vy) of the flow cell containing this node (same piece of code as below)</p>
<p>discard if flow cell is off-bounds</p>
<p>increment the proper linked list</p>
<p>then use the given 4d grid and write values in given array</p>
<p>if the given grid is strictly contained in the lbf grid, we can reduce the number of flow cells where f is reconstructed</p>
<p>B. Preparatory work for the linearization of the flow on the flow cells: find out the closest particle to each cell center, by looping over all particles and noting which flow cell contains it. (The leftmost flow cell in each dimension may not be complete.)</p>
<p>find absolute (x_k,y_k,vx_k,vy_k) coordinates for k-th particle.</p>
<p>which flow cell is this particle in?</p>
<p>discard this particle if off-bounds</p>
<p>C. loop on the flow cells (main loop): on each flow cell, we</p><ul>
<li>C.1 linearize the flow using the position of the particles</li>
<li>C.2 find the relevant points where f should be reconstructed</li>
<li>C.3 reconstruct f on these points (using the affine backward flow and the interpolation tool for the remapped_f)</li>
<li>C.4 write the resulting f value on the proper place</li>
</ul>
<p>here the domain corresponds to the Poisson mesh</p>
<p>here the domain corresponds to the Poisson mesh</p>
<p>Find the particle which is closest to the cell center &ndash; and if we do not have it yet, look on the neighboring cells</p>
<ul>
<li>C.1 linearize the flow using the position of the particles</li>
</ul>
<p>In this flow cell we will use the k-th backward flow, requires the deformation matrix of the k-th particle</p>
<p>Find position of particle k at time 0</p>
<p>initially the particles are on the center of the lbf cells (also the flow grid)</p>
<ul>
<li>C.2 find the relevant points (x, y, vx, vy) where f should be reconstructed<ul>
<li>C.2.a first we treat the case of [remapping with a sparse grid] or [computing the weights of a cloud of deposition particles]: nodes are stored in linked lists</li>
</ul>
</li>
</ul>
<p>node coordinates relative to current particle position</p>
<p>find z_t0 = (x_t0, y_t0, vx_t0, vy_t0), the position of the node at time = 0 using the affine bwd flow</p>
<p>put back z_t0 inside domain (if needed) to enforce periodic boundary conditions</p>
<p>now (x_t0, y_t0, vx_t0, vy_t0) is the (approx) position of the node at time t=0</p>
<p>interpolate and store nodal value on ad-hoc array</p>
<ul>
<li>C.2.b next we treat the case of a remapping with splines or writing on a given grid (in both cases the nodes are on the g grid constructed above)</li>
</ul>
<p>loop over the grid points inside this flow cell:</p>
<p>points in the grid are of the form d(i) = g_grid_d_min + (i-1) * h_g_grid_d, i = 1, .. g_num_points_d (with d = x, y, vx or vy and g_num_points_d = g_num_cells_d or g_num_cells_d+1 , depending on the periodicity) and this flow cell has the form [flow_grid_d_min + (j-1) * h_flow_grid_d, flow_grid_d_min + j * h_flow_grid_d[ so eta_d(i) is in this flow cell if i_min &lt;= i &lt;= i_max where i_min = ceiling( (flow_grid_min - g_grid_d_min + (j-1)*h_flow_grid_d)/h_g_grid_d + 1 ) and i_max = ceiling( (flow_grid_min - g_grid_d_min + (j) *h_flow_grid_d)/h_g_grid_d + 1 ) - 1</p>
<p>C.3 reconstruct the value of f at z_i = (x,y,vx,vy) for this we need z_t0, the position of the z_i at time = 0, using the affine backward flow</p>
<p>put back z_t0 inside domain (if needed) to enforce periodic boundary conditions</p>
<p>now (x_t0, y_t0, vx_t0, vy_t0) is the (approx) position of the node z_i at time t=0</p>
<p>interpolation here may use sparse grid or splines, depending on the method chosen for self</p>
<p>C.4 write the reconstructed value at proper place</p>
<p>this is the end of the (fourfold) loop on the grid nodes</p>
<p>and this is the end of (fourfold) loop on the flow cells</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00844">844</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a8d0fbfbcefa33b4905389cc58fbeda05_cgraph.svg" width="370" height="287"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad5e13e2a9873ee5ec306356da83eda6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e13e2a9873ee5ec306356da83eda6e">&#9670;&nbsp;</a></span>reconstruct_f_lbf_on_given_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::reconstruct_f_lbf_on_given_grid </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structsll__m__cartesian__meshes_1_1sll__t__cartesian__mesh__4d.html">sll_t_cartesian_mesh_4d</a>), intent(in), pointer&#160;</td>
          <td class="paramname"><em>given_grid_4d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(:,:,:,:), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>given_array_4d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>reconstruct_f_on_last_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>target_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>enforce_total_charge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reconstruct_f_lbf_on_remapping_grid ------------------------------------------------------------------------------------&mdash; layer for reconstruct_f_lbf, when reconstructing f on a given grid </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l01533">1533</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="adbb8d3258ffcc102190fcd9f887389f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbb8d3258ffcc102190fcd9f887389f4">&#9670;&nbsp;</a></span>reconstruct_f_lbf_on_remapping_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::reconstruct_f_lbf_on_remapping_grid </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reconstruct_f_lbf_on_remapping_grid ------------------------------------------------------------------------------------&mdash; layer for reconstruct_f_lbf, when reconstructing f on the remapping grid </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l01506">1506</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="ac1e3ded1bdad15c03d4cf145ebe4f4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1e3ded1bdad15c03d4cf145ebe4f4ac">&#9670;&nbsp;</a></span>resample()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::resample </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>target_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>enforce_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structsll__m__initial__distribution_1_1sll__c__distribution__params.html">sll_c_distribution_params</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>init_f_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>rand_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in), optional&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in), optional&#160;</td>
          <td class="paramname"><em>world_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>resample (and sample) --------------------------------------------------------------------------------------------------&mdash; this routine essentially does 2 things: </p>
<ul>
<li>(re)set the particles on the initial grid</li>
<li>computes new interpolation (sparse grid) coefficients so that the remapped_f is an approximation of the target density f &ndash; note: if not initial step (true remap), the evaluation of the transported f relies on the lbf method </li>
</ul>
<p>A. write the nodal values of the target density f, then compute the new interpolation coefs</p>
<ul>
<li>A.1 write the nodal values of f on the arrays of interpolation coefs</li>
</ul>
<p>write initial density f0 on remapping grid</p>
<p>reconstruct transported density fn on remapping grid with the lbf method</p>
<p>compute the sparse grid interpolation coefs for remapped_f, using the nodal values stored in the tmp array</p>
<p>B. reset the particles on the cartesian grid</p>
<p>since the remapping tool has been reset, computing the weights can be done with straightforward interpolation (flow = Id)</p>
<p>not needed for now, but prevents warnings</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00483">483</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a51a50ee826089e37eaa91d719d398753"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51a50ee826089e37eaa91d719d398753">&#9670;&nbsp;</a></span>reset_particles_positions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::reset_particles_positions </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reset_particles_positions ----------------------------------------------------------------------------------------------&mdash; reset the particles on the initial (cartesian) grid &ndash; we use the (multi-purpose) lbf grid &ndash; NOTE: particles will be located at the center of each cell (to avoid a particular treatment of periodic domains) </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00556">556</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a51a50ee826089e37eaa91d719d398753_cgraph.svg" width="423" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a450be1dcd1264dea91377d49951443cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450be1dcd1264dea91377d49951443cb">&#9670;&nbsp;</a></span>reset_particles_weights_with_direct_interpolation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::reset_particles_weights_with_direct_interpolation </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>target_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>enforce_total_charge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reset_particles_weights_with_direct_interpolation ----------------------------------------------------------------------&mdash; compute (and set) the particle weights using a direct interpolation (here, sparse grid) &ndash; does not change the position of the deposition particles </p>
<p>set the particle group common_weight to 1 (will be a factor of each particle weight)</p>
<p>5 is the first weight index</p>
<p>5 is the first weight index</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00742">742</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a494e65998fd6a757facd995773e3f976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a494e65998fd6a757facd995773e3f976">&#9670;&nbsp;</a></span>sample()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::sample </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>target_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>enforce_total_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structsll__m__initial__distribution_1_1sll__c__distribution__params.html">sll_c_distribution_params</a>), intent(in)&#160;</td>
          <td class="paramname"><em>init_f_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>rand_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in), optional&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in), optional&#160;</td>
          <td class="paramname"><em>world_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sample (layer for resample procedure) ----------------------------------------------------------------------------------&mdash; this routine essentially does 2 things: </p>
<hr  />
<p> Below this line are functions specific to the lbf particles with resampling --------------------------------------------&mdash; * locates the particles on an initial cartesian grid,</p><ul>
<li>computes interpolation (sparse grid) coefficients to approximate the initial distribution <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">init_f_params</td><td>parameters of the initial distribution </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00461">461</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="af07829ac7f014e188bee3876add24357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07829ac7f014e188bee3876add24357">&#9670;&nbsp;</a></span>set_common_weight_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::set_common_weight_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the common weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>common weight </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00276">276</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a22c383557ce166737f07d02d7ed406e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22c383557ce166737f07d02d7ed406e5">&#9670;&nbsp;</a></span>set_v_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::set_v_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the velocity of a particle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>component 1 and 2 hold the particle velocity to be set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00254">254</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="ac604cda68a7d4ca9153c82a11dcde28f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac604cda68a7d4ca9153c82a11dcde28f">&#9670;&nbsp;</a></span>set_weights_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::set_weights_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(self%n_weights), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the weights of a particle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>particle weight(s) to be set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00265">265</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a57d4fd31294cc5ab020aceee2ff95049"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d4fd31294cc5ab020aceee2ff95049">&#9670;&nbsp;</a></span>set_x_2d2v_lbf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::set_x_2d2v_lbf </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a> ), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setters ----------------------------------------------------------------------------------------------------------------&mdash;. </p>
<p>Set the position of a particle </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>particle group </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>particle index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>components 1 and 2 hold the particle position to be set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00243">243</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="afd7436d27d911764b09845a4755911bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd7436d27d911764b09845a4755911bb">&#9670;&nbsp;</a></span>sll_f_add_element_in_int_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element.html">sll_t_int_list_element</a> ) function, pointer sll_m_particle_group_2d2v_lbf::sll_f_add_element_in_int_list </td>
          <td>(</td>
          <td class="paramtype">type( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element.html">sll_t_int_list_element</a> ), pointer&#160;</td>
          <td class="paramname"><em>head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( <a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__int__list__element.html">sll_t_int_list_element</a> ), pointer&#160;</td>
          <td class="paramname"><em>new_element</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sll_f_add_element_in_int_list ------------------------------------------------------------------------------------------&mdash; list management </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l02054">2054</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_afd7436d27d911764b09845a4755911bb_icgraph.svg" width="350" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa93c60aa5f0430a547ce02f5768b505c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93c60aa5f0430a547ce02f5768b505c">&#9670;&nbsp;</a></span>sll_s_new_particle_group_2d2v_lbf_ptr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public sll_m_particle_group_2d2v_lbf::sll_s_new_particle_group_2d2v_lbf_ptr </td>
          <td>(</td>
          <td class="paramtype">class( <a class="el" href="structsll__m__particle__group__base_1_1sll__c__particle__group__base.html">sll_c_particle_group_base</a> ), intent(out), pointer&#160;</td>
          <td class="paramname"><em>particle_group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>species_charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>species_mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>domain_is_x_periodic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>domain_is_y_periodic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>remap_degree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>remapping_grid_eta_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>remapping_grid_eta_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), dimension(4), intent(in)&#160;</td>
          <td class="paramname"><em>remapping_sparse_grid_max_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>n_particles_vy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for abstract type. </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00386">386</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="a853fc5fca7bb0ba78fbc632c0ae8f5c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853fc5fca7bb0ba78fbc632c0ae8f5c3">&#9670;&nbsp;</a></span>update_closest_particle_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::update_closest_particle_arrays </td>
          <td>(</td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>k_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>x_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>y_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>vx_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>vy_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_cell_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_cell_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_cell_vx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), intent(in)&#160;</td>
          <td class="paramname"><em>h_cell_vy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=i32), dimension(:,:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>closest_particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=f64), dimension(:,:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>closest_particle_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>update_closest_particle_arrays -----------------------------------------------------------------------------------------&mdash; update the arrays closest_particle and closest_particle_distance with the index of the given particle if closer to what had been stored up to now. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x_aux</td><td>x_particle - flow_grid_x_min </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y_aux</td><td>idem </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vx_aux</td><td>idem </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vy_aux</td><td>idem </td></tr>
  </table>
  </dd>
</dl>
<p>if new particle is closer to center, keep the new one</p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l02145">2145</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacesll__m__particle__group__2d2v__lbf_a853fc5fca7bb0ba78fbc632c0ae8f5c3_icgraph.svg" width="391" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a56539bc9169e9fdcebd3faa64eae7957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56539bc9169e9fdcebd3faa64eae7957">&#9670;&nbsp;</a></span>write_known_density_on_remapping_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sll_m_particle_group_2d2v_lbf::write_known_density_on_remapping_grid </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="structsll__m__particle__group__2d2v__lbf_1_1sll__t__particle__group__2d2v__lbf.html">sll_t_particle_group_2d2v_lbf</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(<a class="el" href="structsll__m__initial__distribution_1_1sll__c__distribution__params.html">sll_c_distribution_params</a>), intent(in)&#160;</td>
          <td class="paramname"><em>distribution_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>write_known_density_on_remapping_grid ----------------------------------------------------------------------------------&mdash; this routine writes a given distribution on the interpolation (sparse grid) nodes to further approximate it </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00528">528</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7618e792c8fc501390695c1027bc0d03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7618e792c8fc501390695c1027bc0d03">&#9670;&nbsp;</a></span>sll_p_lbf_given_grid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(kind=i32), parameter sll_p_lbf_given_grid = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00061">61</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
<a id="aa99d08545655ad53138b0dcef8ad4fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa99d08545655ad53138b0dcef8ad4fee">&#9670;&nbsp;</a></span>sll_p_lbf_remapping_grid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(kind=i32), parameter sll_p_lbf_remapping_grid = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>possible values for the parameter reconstruction_set_type in the reconstruction routine </p>

<p class="definition">Definition at line <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html#l00060">60</a> of file <a class="el" href="sll__m__particle__group__2d2v__lbf_8_f90_source.html">sll_m_particle_group_2d2v_lbf.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/>
<div id="url"></div>
<div align=left><a href="https://github.com/selalib/selalib/issues/new"><small>&nbsp; &nbsp; Report Typos and Errors</small></a></div>
<address class="footer"><small>
Generated on Mon Jul 17 2023 07:57:40 for Semi-Lagrangian Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
</html>
