set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${sll_BINARY_DIR}/lib)
set(CMAKE_Fortran_MODULE_DIRECTORY "${sll_BINARY_DIR}/include")

set(CMAKE_Fortran_FLAGS "-g -Wall -cpp -ffree-line-length-none -fall-intrinsics")

set(files "")
FOREACH(dir ${LOW_LEVEL_LIST_DIR})
	FILE(GLOB sub_files "${CMAKE_SOURCE_DIR}/${dir}/*.F90")
	FILE(GLOB sub_test_files "${CMAKE_SOURCE_DIR}/${dir}/*test*.F90")
	IF(NOT "${sub_test_files}" STREQUAL "")
		LIST(REMOVE_ITEM sub_files ${sub_test_files})
	ENDIF()
	set(files ${sub_files} ${files})
ENDFOREACH(dir)
add_library(selalib_low_level STATIC selalib_low_level.F90 ${files})

set(files "")
FOREACH(dir ${MID_LEVEL_LIST_DIR})
	FILE(GLOB sub_files "${CMAKE_SOURCE_DIR}/${dir}/*.F90")
	FILE(GLOB sub_test_files "${CMAKE_SOURCE_DIR}/${dir}/*test*.F90")
	IF(NOT "${sub_test_files}" STREQUAL "")
		LIST(REMOVE_ITEM sub_files ${sub_test_files})
	ENDIF()
	IF(dir STREQUAL fft)
		LIST(REMOVE_ITEM sub_files ${CMAKE_SOURCE_DIR}/${dir}/fftpack_lib.F90
					   ${CMAKE_SOURCE_DIR}/${dir}/my_lib.F90
					   ${CMAKE_SOURCE_DIR}/${dir}/fftw_lib.F90 )
	ENDIF()
	IF(${dir} STREQUAL "fftpack")
			set(sub_files ${CMAKE_SOURCE_DIR}/${dir}/fftpack.f90 ${CMAKE_SOURCE_DIR}/${dir}/dfftpack.f)
	ENDIF()
	SET(files ${sub_files} ${files})
ENDFOREACH(dir)
add_library(selalib_mid_level STATIC selalib_mid_level.F90 ${files})